extends ../layouts/base

block content
    include ../common/retreiveAlertFromBE


    #main-content.relative.w-full.h-full.overflow-y-auto.bg-gray-50.p-3.pt-5(class='lg:ml-64 dark:bg-gray-900' style="height: 100vh")
        script(src='https://code.jquery.com/jquery-3.5.1.min.js', crossorigin='anonymous')
        script(src='https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js', integrity='sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo', crossorigin='anonymous')
        link(rel='stylesheet', href='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css', integrity='sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh', crossorigin='anonymous')
        script(src='https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js', integrity='sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6', crossorigin='anonymous')
        link(href='https://cdn.jsdelivr.net/npm/summernote@0.9.0/dist/summernote-bs4.min.css', rel='stylesheet')
        script(src='https://cdn.jsdelivr.net/npm/summernote@0.9.0/dist/summernote-bs4.min.js')

        input#keyTitleField.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="Nội dung" style="border: none")

        input#titleField.block.w-full.p-2.text-gray-900.border.border-gray-300.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3')
     
        input#keyTitleField1.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="Cấu trúc" style="border: none")
        input#titleField1.block.w-full.p-2.text-gray-900.border.border-gray-300.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3')
        input#keyTitleField2.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="Tham gia" style="border: none")
        input#titleField2.block.w-full.p-2.text-gray-900.border.border-gray-300.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3')
        input#keyTitleField3.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="XHPred" style="border: none")
        input#titleField3.block.w-full.p-2.text-gray-900.border.border-gray-300.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3')



        input#keyDescField.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white mt-3' value="XHReal" style="border: none")
        textarea#descField.block.w-full.text-sm.text-gray-900.bg-gray-50.rounded-lg.border.border-gray-300(rows='4', class='p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3', placeholder='Write your thoughts here...')

        input#keyDescField1.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="Kết quả" style="border: none")
        textarea#descField1.block.w-full.text-sm.text-gray-900.bg-gray-50.rounded-lg.border.border-gray-300(rows='4', class='p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3', placeholder='Write your thoughts here...')
        input#keyDescField2.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="Đánh giá" style="border: none")
        textarea#descField2.block.w-full.text-sm.text-gray-900.bg-gray-50.rounded-lg.border.border-gray-300(rows='4', class='p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3', placeholder='Write your thoughts here...')
        input#keyDescField3.block.w-full.p-2.text-gray-900.rounded-lg.bg-gray-50.text-xs(type='text', class='focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 text-4xl font-bold text-gray-900 dark:text-white' value="Mô tả" style="border: none")
        textarea#descField3.block.w-full.text-sm.text-gray-900.bg-gray-50.rounded-lg.border.border-gray-300(rows='4', class='p-2.5 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 mt-3', placeholder='Write your thoughts here...')

        #summernote(style="z-index:0")


        script.
            $('#summernote').summernote({
            placeholder: 'Write something here',
            tabsize: 2,
            height: 500,
            toolbar: [
                    ['style', ['style']],
                    ['font', ['bold', 'italic', 'underline', 'strikethrough', 'superscript', 'subscript', 'clear']],
                    ['fontname', ['fontname']],
                    ['fontsize', ['fontsize']],
                    ['color', ['color']],
                    ['para', ['ul', 'ol', 'paragraph']],
                    ['height', ['height']],
                    ['table', ['table']],
                    ['insert', ['link', 'picture', 'hr']],
                    ['view', ['fullscreen', 'codeview']],
                    ['help', ['help']]
                ],
            });

        // Example Button to trigger sending content
        button#sendButton.btn.btn-primary.w-100.mt-3(type='button') Save note

        script.
            document.getElementById('sendButton').addEventListener('click', function() {
            document.getElementById('sendButton').disabled = true
            // Ngừng sự kiện mặc định (nếu có)
            event.preventDefault();
            
            //- Lấy giá trị từ các title
            const keyTitle = document.getElementById('keyTitleField').value;
            const keyTitle1 = document.getElementById('keyTitleField1').value;
            const keyTitle2 = document.getElementById('keyTitleField2').value;
            const keyTitle3 = document.getElementById('keyTitleField3').value;
            const keyDesc = document.getElementById('keyDescField').value;
            const keyDesc1 = document.getElementById('keyDescField1').value;
            const keyDesc2 = document.getElementById('keyDescField2').value;
            const keyDesc3 = document.getElementById('keyDescField3').value;

            // Lấy giá trị từ các input field
            const title = document.getElementById('titleField').value;
            const title1 = document.getElementById('titleField1').value;
            const title2 = document.getElementById('titleField2').value;
            const title3 = document.getElementById('titleField3').value;
            const desc = document.getElementById('descField').value;
            const desc1 = document.getElementById('descField1').value;
            const desc2 = document.getElementById('descField2').value;
            const desc3 = document.getElementById('descField3').value;
            //- const htmleditor = document.getElementById('summernote').value; // Nếu summernote là textarea
            const htmleditor = document.querySelector('.note-editable').innerHTML; // Nếu summernote là textarea
            // Tạo dữ liệu để gửi đi (dạng x-www-form-urlencoded)
            const formData = new URLSearchParams();
            formData.append('title', JSON.stringify({ key: keyTitle, content: title }));
            formData.append('title1', JSON.stringify({ key: keyTitle1, content: title1 }));
            formData.append('title2', JSON.stringify({ key: keyTitle2, content: title2 }));
            formData.append('title3', JSON.stringify({ key: keyTitle3, content: title3 }));
            formData.append('desc', JSON.stringify({ key: keyDesc, content: desc }));
            formData.append('desc1', JSON.stringify({ key: keyDesc1, content: desc1 }));
            formData.append('desc2', JSON.stringify({ key: keyDesc2, content: desc2 }));
            formData.append('desc3', JSON.stringify({ key: keyDesc3, content: desc3 }));
            formData.append('htmleditor', htmleditor);
            // Gửi yêu cầu POST tới server với Axios
            axios.post('/api/v1/note/create', formData, {
            headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Accept': 'application/json',
                    },
                })
                .then(response => {
                    
                    const status = retreiveAlertData(response)

                    if (status) {
                        setTimeout(() => {
                            window.location.href = "/api/v1/note/crud"
                        }, 2500)
                    }
                })
                .catch(error => {

                })
            })